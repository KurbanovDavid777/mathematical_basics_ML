# Laboratory Work 2 ‚Äî Numerical Optimization Methods
# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2 ‚Äî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ –∑–∞–¥–∞—á–∞—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## üá∑üá∫ –û–ø–∏—Å–∞–Ω–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### –ù–∞–∑–≤–∞–Ω–∏–µ
**–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ –∑–∞–¥–∞—á–∞—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã BFGS –∏ L-BFGS, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω–µ—á–Ω–æ-—Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–∫–ª–∞–¥–Ω—ã—Ö –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

### –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
–í –¥–∞–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∑–∞–¥–∞—á–∏ **–±–µ–∑—É—Å–ª–æ–≤–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤. –û—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ—Ç—Å—è –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–º –º–µ—Ç–æ–¥–∞–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Äî **BFGS** –∏ **L-BFGS**, –∞ —Ç–∞–∫–∂–µ –º–µ—Ç–æ–¥–∞–º —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω–µ—á–Ω–æ-—Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã—Ö —Å—Ö–µ–º.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

---

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏:

$$
f(x) \rightarrow \min, \quad x \in \mathbb{R}^n
$$

–≥–¥–µ —Ü–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è $f(x): \mathbb{R}^n \to \mathbb{R}$ —è–≤–ª—è–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–æ–π –∏ –≤—ã–ø—É–∫–ª–æ–π.

–ò—Å–∫–æ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ $x'$ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é:

$$
f(x') \le f(x), \quad \forall x \in \mathbb{R}^n
$$

---

## –ê–ª–≥–æ—Ä–∏—Ç–º BFGS

–ù–∞ $k$-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:

$$
f(x_k + p) = f(x_k) + \nabla f(x_k)^T p + \frac{1}{2} p^T H(x_k) p
$$

–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞:

$$
p_k = -H_k^{-1} \nabla f(x_k)
$$

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∏:

$$
x_{k+1} = x_k + \alpha_k p_k
$$

–≥–¥–µ —à–∞–≥ $\alpha_k$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **–ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞**, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–µ–≥–æ **—É—Å–ª–æ–≤–∏—è–º –í–æ–ª—å—Ñ–µ**.

---

## –£—Å–ª–æ–≤–∏—è –í–æ–ª—å—Ñ–µ

–ü–∞—Ä–∞–º–µ—Ç—Ä —à–∞–≥–∞ $\alpha_k$ –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å:

$$
f(x_k + \alpha_k p_k) \le f(x_k) + c_1 \alpha_k \nabla f(x_k)^T p_k
$$

$$
\nabla f(x_k + \alpha_k p_k)^T p_k \ge c_2 \nabla f(x_k)^T p_k
$$

–≥–¥–µ $0 < c_1 < c_2 < 1$.

–î–ª—è –ø–æ–¥–±–æ—Ä–∞ —à–∞–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º **line search** —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π `zoom`.

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ì–µ—Å—Å–µ

–ü—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ì–µ—Å—Å–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

$$
H_{k+1} = (I - \rho_k s_k y_k^T) H_k (I - \rho_k y_k s_k^T) + \rho_k s_k s_k^T
$$

–≥–¥–µ:

$$
s_k = x_{k+1} - x_k, \quad y_k = \nabla f(x_{k+1}) - \nabla f(x_k), \quad \rho_k = \frac{1}{y_k^T s_k}
$$

–ù–∞ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è $H_0 = I$.

---

## –ú–µ—Ç–æ–¥ L-BFGS

–ú–µ—Ç–æ–¥ **L-BFGS** —è–≤–ª—è–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π BFGS –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∑–∞ —Å—á—ë—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤ $s_k$ –∏ $y_k$.

---

## –ß–∏—Å–ª–µ–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–Ω–µ—á–Ω–æ-—Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã–µ —Å—Ö–µ–º—ã:

**–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å—Ö–µ–º–∞ (1-–π –ø–æ—Ä—è–¥–æ–∫):**

$$
\frac{\partial f}{\partial x_j} \approx \frac{f(x + h e_j) - f(x)}{h}
$$

**–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ (2-–π –ø–æ—Ä—è–¥–æ–∫):**

$$
\frac{\partial f}{\partial x_j} \approx \frac{f(x + h e_j) - f(x - h e_j)}{2h}
$$

---

## –ó–∞–¥–∞–Ω–∏—è

### 1. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è:

$$
f(x) = \frac{1}{2} \Big[ x_1^2 + \sum_{i=1}^{2} (x_i - x_{i+1})^2 + x_3^2 \Big] - x_1, \quad x \in \mathbb{R}^3
$$

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥—ã **BFGS** –∏ **L-BFGS** –ø—Ä–∏–º–µ–Ω–∏–º—ã –∫ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ.
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã:
   - BFGS;
   - L-BFGS.

3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏:
   - —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º;
   - —Å —á–∏—Å–ª–µ–Ω–Ω—ã–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º (–∫–æ–Ω–µ—á–Ω—ã–µ —Ä–∞–∑–Ω–æ—Å—Ç–∏).

   ‚ùó –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `scipy.optimize` **–∑–∞–ø—Ä–µ—â–µ–Ω–æ**.

4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã –ì–µ—Å—Å–µ:
   - –µ–¥–∏–Ω–∏—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞;
   - –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π.

5. –°—Ä–∞–≤–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ:
   - —á–∏—Å–ª—É –∏—Ç–µ—Ä–∞—Ü–∏–π;
   - —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏;
   - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.

---

### 2. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏–∑ **–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã 1**.
2. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥ —á–∏—Å–ª–µ–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞.
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º **Adam** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω–µ—á–Ω–æ-—Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.
4. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
   - BFGS;
   - L-BFGS;
   - Adam (—Å —Ä–∞–∑–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏).
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:
   - –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏;
   - –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è;
   - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

---

## üá¨üáß Task Description (English Version)

### Title
**Laboratory Work 2: Numerical Methods for Optimization**

### Objective
To study modern numerical optimization methods, implement BFGS and L-BFGS algorithms, and apply finite-difference gradient approximations to solve optimization problems and train machine learning models.

### Description
This lab focuses on unconstrained optimization using numerical methods. The main emphasis is placed on quasi-Newton methods (BFGS and L-BFGS) and numerical differentiation techniques.

Additionally, the implemented optimization methods are applied to train a machine learning model.

---

## Tasks

### 1. Optimization Algorithms Study

Given the function:

$$
f(x) = \frac{1}{2} \Big[ x_1^2 + \sum_{i=1}^{2} (x_i - x_{i+1})^2 + x_3^2 \Big] - x_1
$$

1. Show that **BFGS** and **L-BFGS** are applicable to this problem.
2. Implement:
   - BFGS;
   - L-BFGS.

3. For each method, implement:
   - analytical gradient;
   - numerical gradient using finite differences.

   ‚ùó Usage of `scipy.optimize` is not allowed.

4. Implement different Hessian initializations.
5. Compare convergence behavior and performance.

---

### 2. Machine Learning Application

1. Use the machine learning model from **Laboratory Work 1**.
2. Adapt training to numerical gradient computation.
3. Implement **Adam** optimizer with finite-difference gradients.
4. Train the model using:
   - BFGS;
   - L-BFGS;
   - Adam.
5. Compare performance, training time, and stability.

---

## Expected Deliverables

- Jupyter Notebook with full implementations.
- Plots and convergence analysis.
- Conclusions on optimization methods efficiency.

